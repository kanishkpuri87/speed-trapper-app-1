
<!DOCTYPE html>

<html>
<head>
   
    <script src="../../Scripts/jquery-1.10.2.js"></script>
    <script src="../../Scripts/jquery.signalR-2.1.2.js"></script>

    <!--Reference the autogenerated SignalR hub script. -->
    <script src="http://localhost:57040/SignalR/hubs"></script>
    <meta name="viewport" content="width=device-width" />
    <title>Speedjoin</title>
</head>
<body>
    <div>
        <input type="text" id="carname">
        <input type="text" id="carspeed">

        
        <input type="button" id="joinCar" value="Car" />
        <div id="discussion"></div>
    </div>
</body>
</html>
<script>
    $(function () {
        // Reference the auto-generated proxy for the hub.
        $(function () {
            $.support.cors = true;
            $.get('../../resources/car-names.txt', function(data) {
                $.support.cors = true;
                var quotes = data.split("");
                var idx = Math.floor(quotes.length * Math.random());
                console.log(quotes[idx]);
            });
            
        $.support.cors = true;
        $.connection.hub.url = 'http://localhost:57040/signalr';
        var chat = $.connection.notificationHub;
        chat.client.broadcastMessage = function broadcastMessage(name, message, speed) {
            // Add the message to the page.
            if (message ==0)
            { $('#discussion').append('<div  style=" float:left;margin-left:10px;"><span style="font-size:x-large; ">My Name is ' + name + '</span><br />    <span style="font-size:x-large; color:forestgreen">' + speed + 'KM</span></div>'); }

            else { $('#discussion').append('<div  style=" float:left;margin-left:10px;"><span style="font-size:x-large; ">My Name is' + name + '</span><br />    <span style="font-size:x-large; color:red">You are busted</span><br />    <span style="font-size:x-large; color:red">(' + speed + ')</span></div>'); }
        };

        $('#joinCar').click(function () {

            chat.server.send($('#carname').val(), $('#carspeed').val());

        });
        $.connection.hub.start({jsonp:true}).done(function () {

        });
    });
    // This optional function html-encodes messages for display in the page.
    function htmlEncode(value) {
        var encodedValue = $('<div />').text(value).html();
        return encodedValue;
    }
</script>

